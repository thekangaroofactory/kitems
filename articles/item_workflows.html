<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Item Workflows • kitems</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="item_workflows_files/libs/quarto-html/popper.min.js"></script><script src="item_workflows_files/libs/quarto-html/tippy.umd.min.js"></script><link href="item_workflows_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="item_workflows_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Item Workflows">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kitems</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/kitems.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/core-concepts.html">core-concepts</a></li>
    <li><a class="dropdown-item" href="../articles/shiny-module.html">Shiny Module</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Item Workflows</h1>





      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>One of the purpose of the module server is to offer flexible implementation options.<br>
To support this key capability, specific workflows had to be implemented when it comes to item management (create / update / delete operations).</p>
<p>This article focuses on these workflows and how to make use of them.</p>
</section><section class="level2"><h2 id="create-workflow">Create workflow<a class="anchor" aria-label="anchor" href="#create-workflow"></a>
</h2>
<section class="level3"><h3 id="full-delegation">Full delegation<a class="anchor" aria-label="anchor" href="#full-delegation"></a>
</h3>
<p>The standard way to create items is to implement the create button widget in the application UI.<br>
When clicked by the user, the button will fire a creation dialog with the input form.<br>
A confirmation button in this dialog is used to launch the creation process based on the input values and the item is inserted in the item table.</p>
</section><section class="level3"><h3 id="mixed-implementation">Mixed implementation<a class="anchor" aria-label="anchor" href="#mixed-implementation"></a>
</h3>
<p>Another way is to fire the create item dialog directly from the main application server (it’s useful when you don’t want to implement the create button in the application UI).<br>
An event can be sent to the module trigger parameter :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"create"</span>, type <span class="op">=</span> <span class="st">"dialog"</span><span class="op">)</span></span></code></pre></div>
<p>From there, the creation process will work the same way as it does after the create button is clicked.</p>
</section><section class="level3"><h3 id="full-background">Full background<a class="anchor" aria-label="anchor" href="#full-background"></a>
</h3>
<p>The third and last option is to rely on a full server-side process.<br>
This is particularly useful when the item creation does not rely on user input, or when you want to implement your own input form.<br>
A specific event is used to trigger this back-end creation process:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"create"</span>, type <span class="op">=</span> <span class="st">"task"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The values are the ones to be used to create the new item.<br>
The names in the list should fit with the names of the corresponding attributes (otherwise they will be dropped).<br>
Partial value list is supported, meaning that the workflow will add missing attributes and take the values from the default defined in the data model.<br>
This back-end process also supports creating multiple items at once. If so, elements in the list <em>must</em> have length 1 (all items will get same value for this attribute) or same length as the expected number of items. If not, the process will fail as it is not safe to guess whats the intention behind such a list.<br>
In case existing ids are send along the list, the corresponding items will be skipped to avoid item duplication (it’s better to send a list without id and let the data model generate them).</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="image/create_workflow.JPG"></p>
<figcaption>Create workflow</figcaption></figure>
</div>
</section></section><section class="level2"><h2 id="update-workflow">Update workflow<a class="anchor" aria-label="anchor" href="#update-workflow"></a>
</h2>
<p>In the same way as for the create workflow, the update one offers three types of implementations.</p>
<section class="level3"><h3 id="full-delegation-1">Full delegation<a class="anchor" aria-label="anchor" href="#full-delegation-1"></a>
</h3>
<p>The standard process to update an item is to select it in the item table from the application UI.<br>
This triggers the update button to be set visible. When the user clicks on it, the update dialog window is displayed and is initialized with the item’s values.<br>
After the user confirms the update, the input values are used to update the corresponding attributes in the item table. As usual, these values are checked against the data model and replaced by defaults for example if the user lets an input empty.</p>
</section><section class="level3"><h3 id="mixed-implementation-1">Mixed implementation<a class="anchor" aria-label="anchor" href="#mixed-implementation-1"></a>
</h3>
<p>When the item table is not implemented in the application UI, the update button cannot be used as it directly relies on the selected item.</p>
<p>In this case, it’s possible to use the trigger to fire the update dialog for a specific item:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"update"</span>, type <span class="op">=</span> <span class="st">"dialog"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>From there, the update process will be same as in the first implementation.</p>
</section><section class="level3"><h3 id="full-background-1">Full background<a class="anchor" aria-label="anchor" href="#full-background-1"></a>
</h3>
<p>If the update process does not rely on user input (for example to update an attribute linked to the lifecycle of the item such as progress or state), or if you want to implement your own custom input form, then it is possible to use the trigger in a full back-end update process.</p>
<p>The event is similar to the one used to create items, only the workflow is different:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"update"</span>, type <span class="op">=</span> <span class="st">"task"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The module will use the provided values to update the corresponding items.</p>
<p>Again, partial values are supported, meaning that if you provide an id with a single attribute, only this attribute will be updated for the corresponding item.<br>
It is possible to force the update of a computed value attribute (with the data model default function) by including the name in the list, and set the value to NA. In this case, the data model will be used to define the default value.<br>
Multiple items update is supported as well, with same rules as for the create workflow.<br>
Note that this back-end process is the only way to update multiple items at once.</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="image/update_workflow.jpg"></p>
<figcaption>Update workflow</figcaption></figure>
</div>
</section></section><section class="level2"><h2 id="delete-workflow">Delete workflow<a class="anchor" aria-label="anchor" href="#delete-workflow"></a>
</h2>
<section class="level3"><h3 id="full-delegation-2">Full delegation<a class="anchor" aria-label="anchor" href="#full-delegation-2"></a>
</h3>
<p>The standard way to delete items is from the application UI.<br>
Whenever one or several items are selected in the item table, the delete button is visible and can be used to fire the delete confirmation dialog.</p>
<p>Once the user hits the confirmation button in the dialog, the items are deleted from the item table.</p>
</section><section class="level3"><h3 id="mixed-implementation-2">Mixed implementation<a class="anchor" aria-label="anchor" href="#mixed-implementation-2"></a>
</h3>
<p>Again here, when the item table is not implemented or if you want to have the delete operation available from a contextual element attached to a specific item (for example a marker’s popup on a map), the trigger can be used to fire the delete confirmation dialog.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"delete"</span>, type <span class="op">=</span> <span class="st">"dialog"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>User will hit the confirmation button and items will be removed from the item table.</p>
</section><section class="level3"><h3 id="full-background-2">Full background<a class="anchor" aria-label="anchor" href="#full-background-2"></a>
</h3>
<p>In case you don’t want the confirmation dialog to pop up or need to use a server side process that is not directly linked to the UI, the trigger accepts a specific event that can be used to delete one or several items:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>workflow <span class="op">=</span> <span class="st">"delete"</span>, type <span class="op">=</span> <span class="st">"task"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dots.html" class="external-link">...length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The module server will delete the items with corresponding ids.<br>
Of course if some id(s) are not retrieved, they will be ignored.</p>
<p>It is recommended that your application will secure delete with some confirmation process as the trigger will not ask for any confirmation. This is particularly true when the autosave is set to <code>TRUE</code> as the item table will be saved as soon as it is modified.</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="image/delete_workflow.jpg"></p>
<figcaption>Delete workflow</figcaption></figure>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.linkedin.com/in/philippeperet/" class="external-link">Philippe Peret</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
